{"ast":null,"code":"import { Inject } from '../Application';\nimport { Constants, ContentType, ErrorCode, Events } from '../Contract';\nimport { NetworkException } from '../System';\nimport { RequestConfig } from '.';\n\nvar HttpServer = function () {\n  function HttpServer(inject) {\n    if (inject === void 0) {\n      inject = null;\n    }\n\n    this.inject = inject || Inject.Instance;\n    this.library = this.inject.resolve(Constants.Library);\n    this.event = this.inject.resolve(Constants.EventAggregator);\n  }\n\n  HttpServer.prototype.get = function (url, params, callback) {\n    var _this = this;\n\n    var request = this.library.query.get(url, params);\n    request.done(function (result) {\n      return _this.ExecuteResponse(result, callback);\n    });\n    request.fail(this.failedResponse(callback));\n  };\n\n  HttpServer.prototype.post = function (url, data, callback, config) {\n    var _this = this;\n\n    var request = this.sendRequest(url, data, config);\n    request.always(function () {\n      _this.event.publish(Events.ActionComplete);\n    });\n    request.done(function (response) {\n      if (callback) {\n        callback(response);\n      }\n    });\n    request.fail(this.failedResponse(callback));\n  };\n\n  HttpServer.prototype.failedResponse = function (callback) {\n    var _this = this;\n\n    return function (response) {\n      if (response.status) {\n        _this.event.publish(Events.Error, new NetworkException(response.responseText, response.status));\n      }\n\n      if (callback) {\n        callback(response);\n      }\n    };\n  };\n\n  HttpServer.prototype.ExecuteResponse = function (response, callback) {\n    this.validateResponse(response);\n\n    if (callback) {\n      callback(response);\n    }\n  };\n\n  HttpServer.prototype.validateResponse = function (response) {\n    if (response.ErrorOcurred) {\n      var message = response.ExMessage + \"<pre>\" + response.ExStackTrace + \"<pre>\";\n      throw new NetworkException(message, ErrorCode.ServerError);\n    }\n  };\n\n  HttpServer.prototype.sendRequest = function (url, data, config) {\n    config = config || new RequestConfig();\n    config.contentType = config.contentType || ContentType.applicationJson;\n\n    if (config.contentType && config.contentType === ContentType.multipartFormdata) {\n      return this.processFormData(url, data);\n    } else {\n      return this.processDefault(url, data, config);\n    }\n  };\n\n  HttpServer.prototype.processFormData = function (url, data) {\n    var _this = this;\n\n    return this.library.query.ajax(url, {\n      beforeSend: function () {\n        _this.event.publish(Events.ActionSending);\n      },\n      contentType: false,\n      data: data,\n      headers: {\n        WM: true\n      },\n      processData: false,\n      type: 'POST'\n    });\n  };\n\n  HttpServer.prototype.processDefault = function (url, data, config) {\n    var _this = this;\n\n    config.headers.WM = 'true';\n    return this.library.query.ajax(url, {\n      beforeSend: function () {\n        _this.event.publish(Events.ActionSending);\n      },\n      contentType: config.contentType,\n      data: data,\n      dataType: 'json',\n      headers: config.headers,\n      type: 'POST'\n    });\n  };\n\n  return HttpServer;\n}();\n\nexport { HttpServer }; //# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiSHR0cFNlcnZlci5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9TZXJ2ZXIvSHR0cFNlcnZlci50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFrQkEsT0FBTyxFQUFFLE1BQU0sRUFBRSxNQUFNLGdCQUFnQixDQUFDO0FBQ3hDLE9BQU8sRUFBRSxTQUFTLEVBQUUsV0FBVyxFQUFFLFNBQVMsRUFBRSxNQUFNLEVBQWdFLE1BQU0sYUFBYSxDQUFDO0FBQ3RJLE9BQU8sRUFBRSxnQkFBZ0IsRUFBRSxNQUFNLFdBQVcsQ0FBQztBQUU3QyxPQUFPLEVBQUUsYUFBYSxFQUFFLE1BQU0sR0FBRyxDQUFDO0FBRWxDO0lBRUksb0JBQVksTUFBc0I7UUFBdEIsdUJBQUEsRUFBQSxhQUFzQjtRQUM5QixJQUFJLENBQUMsTUFBTSxHQUFHLE1BQU0sSUFBSSxNQUFNLENBQUMsUUFBUSxDQUFDO1FBQ3hDLElBQUksQ0FBQyxPQUFPLEdBQUcsSUFBSSxDQUFDLE1BQU0sQ0FBQyxPQUFPLENBQUMsU0FBUyxDQUFDLE9BQU8sQ0FBQyxDQUFDO1FBQ3RELElBQUksQ0FBQyxLQUFLLEdBQUcsSUFBSSxDQUFDLE1BQU0sQ0FBQyxPQUFPLENBQUMsU0FBUyxDQUFDLGVBQWUsQ0FBQyxDQUFDO0lBQ2hFLENBQUM7SUFNRCx3QkFBRyxHQUFILFVBQUksR0FBVyxFQUFFLE1BQWEsRUFBRSxRQUFpQztRQUFqRSxpQkFJQztRQUhHLElBQU0sT0FBTyxHQUFHLElBQUksQ0FBQyxPQUFPLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxHQUFHLEVBQUUsTUFBTSxDQUFDLENBQUM7UUFDcEQsT0FBTyxDQUFDLElBQUksQ0FBQyxVQUFBLE1BQU0sSUFBSSxPQUFBLEtBQUksQ0FBQyxlQUFlLENBQUMsTUFBTSxFQUFFLFFBQVEsQ0FBQyxFQUF0QyxDQUFzQyxDQUFDLENBQUM7UUFDL0QsT0FBTyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsY0FBYyxDQUFDLFFBQVEsQ0FB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Q2xCLElBQUksRUFBRSxNQUFNO1NBQ2YsQ0FBQyxDQUFDO0lBQ1AsQ0FBQztJQUVPLG1DQUFjLEdBQXRCLFVBQXVCLEdBQVcsRUFBRSxJQUFTLEVBQUUsTUFBc0I7UUFBckUsaUJBYUM7UUFYRyxNQUFNLENBQUMsT0FBTyxDQUFDLEVBQUUsR0FBRyxNQUFNLENBQUM7UUFDM0IsT0FBTyxJQUFJLENBQUMsT0FBTyxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsR0FBRyxFQUFFO1lBQ2hDLFVBQVUsRUFBRTtnQkFDUixLQUFJLENBQUMsS0FBSyxDQUFDLE9BQU8sQ0FBQyxNQUFNLENBQUMsYUFBYSxDQUFDLENBQUM7WUFDN0MsQ0FBQztZQUNELFdBQVcsRUFBRSxNQUFNLENBQUMsV0FBVztZQUMvQixJQUFJLE1BQUE7WUFDSixRQUFRLEVBQUUsTUFBTTtZQUNoQixPQUFPLEVBQUUsTUFBTSxDQUFDLE9BQU87WUFDdkIsSUFBSSxFQUFFLE1BQU07U0FDZixDQUFDLENBQUM7SUFDUCxDQUFDO0lBQ0wsaUJBQUM7QUFBRCxDQUFDLEFBL0ZELElBK0ZDIiwic291cmNlc0NvbnRlbnQiOlsiLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXHJcbiogQ29weXJpZ2h0IChDKSBNb2JpbGl6ZS5OZXQgPGluZm9AbW9iaWxpemUubmV0PiAtIEFsbCBSaWdodHMgUmVzZXJ2ZWRcclxuKlxyXG4qIFRoaXMgZmlsZSBpcyBwYXJ0IG9mIHRoZSBNb2JpbGl6ZSBGcmFtZXdvcmtzLCB3aGljaCBpc1xyXG4qIHByb3ByaWV0YXJ5IGFuZCBjb25maWRlbnRpYWwuXHJcbipcclxuKiBOT1RJQ0U6ICBBbGwgaW5mb3JtYXRpb24gY29udGFpbmVkIGhlcmVpbiBpcywgYW5kIHJlbWFpbnNcclxuKiB0aGUgcHJvcGVydHkgb2YgTW9iaWxpemUuTmV0IENvcnBvcmF0aW9uLlxyXG4qIFRoZSBpbnRlbGxlY3R1YWwgYW5kIHRlY2huaWNhbCBjb25jZXB0cyBjb250YWluZWQgaGVyZWluIGFyZVxyXG4qIHByb3ByaWV0YXJ5IHRvIE1vYmlsaXplLk5ldCBDb3Jwb3JhdGlvbiBhbmQgbWF5IGJlIGNvdmVyZWRcclxuKiBieSBVLlMuIFBhdGVudHMsIGFuZCBhcmUgcHJvdGVjdGVkIGJ5IHRyYWRlIHNlY3JldCBvciBjb3B5cmlnaHQgbGF3LlxyXG4qIERpc3NlbWluYXRpb24gb2YgdGhpcyBpbmZvcm1hdGlvbiBvciByZXByb2R1Y3Rpb24gb2YgdGhpcyBtYXRlcmlhbFxyXG4qIGlzIHN0cmljdGx5IGZvcmJpZGRlbiB1bmxlc3MgcHJpb3Igd3JpdHRlbiBwZXJtaXNzaW9uIGlzIG9idGFpbmVkXHJcbiogZnJvbSBNb2JpbGl6ZS5OZXQgQ29ycG9yYXRpb24uXHJcbipcclxuKiBUaGlzIGZpbGUgaXMgc3ViamVjdCB0byB0aGUgdGVybXMgYW5kIGNvbmRpdGlvbnMgZGVmaW5lZCBpblxyXG4qIGZpbGUgJ0xJQ0VOU0UudHh0Jywgd2hpY2ggaXMgcGFydCBvZiB0aGlzIHNvdXJjZSBjb2RlIHBhY2thZ2UuXHJcbioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xyXG5pbXBvcnQgeyBJbmplY3QgfSBmcm9tICcuLi9BcHBsaWNhdGlvbic7XHJcbmltcG9ydCB7IENvbnN0YW50cywgQ29udGVudFR5cGUsIEVycm9yQ29kZSwgRXZlbnRzLCBJRXZlbnRBZ2dyZWdhdG9yLCBJSW5qZWN0LCBJTGlicmFyeSwgSVJlcXVlc3RDb25maWcsIElTZXJ2ZXIgfSBmcm9tICcuLi9Db250cmFjdCc7XHJcbmltcG9ydCB7IE5ldHdvcmtFeGNlcHRpb24gfSBmcm9tICcuLi9TeXN0ZW0nO1xyXG5cclxuaW1wb3J0IHsgUmVxdWVzdENvbmZpZyB9IGZyb20gJy4nO1xyXG5cclxuZXhwb3J0IGNsYXNzIEh0dHBTZXJ2ZXIgaW1wbGVtZW50cyBJU2VydmVyIHtcclxuXHJcbiAgICBjb25zdHJ1Y3RvcihpbmplY3Q6IElJbmplY3QgPSBudWxsKSB7XHJcbiAgICAgICAgdGhpcy5pbmplY3QgPSBpbmplY3QgfHwgSW5qZWN0Lkluc3RhbmNlO1xyXG4gICAgICAgIHRoaXMubGlicmFyeSA9IHRoaXMuaW5qZWN0LnJlc29sdmUoQ29uc3RhbnRzLkxpYnJhcnkpO1xyXG4gICAgICAgIHRoaXMuZXZlbnQgPSB0aGlzLmluamVjdC5yZXNvbHZlKENvbnN0YW50cy5FdmVudEFnZ3JlZ2F0b3IpO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgbGlicmFyeTogSUxpYnJhcnk7XHJcbiAgICBwcml2YXRlIGV2ZW50OiBJRXZlbnRBZ2dyZWdhdG9yO1xyXG4gICAgcHJpdmF0ZSBpbmplY3Q6IElJbmplY3Q7XHJcblxyXG4gICAgZ2V0KHVybDogc3RyaW5nLCBwYXJhbXM6IGFueVtdLCBjYWxsYmFjazogKHJlc3BvbnNlOiBhbnkpID0+IHZvaWQpOiB2b2lkIHtcclxuICAgICAgICBjb25zdCByZXF1ZXN0ID0gdGhpcy5saWJyYXJ5LnF1ZXJ5LmdldCh1cmwsIHBhcmFtcyk7XHJcbiAgICAgICAgcmVxdWVzdC5kb25lKHJlc3VsdCA9PiB0aGlzLkV4ZWN1dGVSZXNwb25zZShyZXN1bHQsIGNhbGxiYWNrKSk7XHJcbiAgICAgICAgcmVxdWVzdC5mYWlsKHRoaXMuZmFpbGVkUmVzcG9uc2UoY2FsbGJhY2spKTtcclxuICAgIH1cclxuXHJcbiAgICBwb3N0KHVybDogc3RyaW5nLCBkYXRhOiBhbnksIGNhbGxiYWNrOiAocmVzcG9uc2U6IGFueSkgPT4gdm9pZCwgY29uZmlnPzogSVJlcXVlc3RDb25maWcpOiBhbnkge1xyXG4gICAgICAgIGNvbnN0IHJlcXVlc3QgPSB0aGlzLnNlbmRSZXF1ZXN0KHVybCwgZGF0YSwgY29uZmlnKTtcclxuICAgICAgICByZXF1ZXN0LmFsd2F5cygoKSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuZXZlbnQucHVibGlzaChFdmVudHMuQWN0aW9uQ29tcGxldGUpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHJlcXVlc3QuZG9uZSgocmVzcG9uc2UpID0+IHtcclxuICAgICAgICAgICAgaWYgKGNhbGxiYWNrKSB7XHJcbiAgICAgICAgICAgICAgICBjYWxsYmFjayhyZXNwb25zZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICByZXF1ZXN0LmZhaWwodGhpcy5mYWlsZWRSZXNwb25zZShjYWxsYmFjaykpO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgZmFpbGVkUmVzcG9uc2UoY2FsbGJhY2s6IChyZXNwb25zZTogYW55KSA9PiB2b2lkKTogYW55IHtcclxuICAgICAgICByZXR1cm4gKHJlc3BvbnNlKSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChyZXNwb25zZS5zdGF0dXMpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuZXZlbnQucHVibGlzaChFdmVudHMuRXJyb3IsIG5ldyBOZXR3b3JrRXhjZXB0aW9uKHJlc3BvbnNlLnJlc3BvbnNlVGV4dCwgcmVzcG9uc2Uuc3RhdHVzKSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgLy8gdGhlIEFjdGlvblNlcnZpY2UgbmVlZHMgdG8gYmUgY2FsbGVkIG9uIGZhaWx1cmUsIHRvIGNsZWFyIHRoZSBwZW5kaW5nIHN0YXR1cyBvZiB0aGUgcmVxdWVzdC5cclxuICAgICAgICAgICAgaWYgKGNhbGxiYWNrKSB7XHJcbiAgICAgICAgICAgICAgICBjYWxsYmFjayhyZXNwb25zZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgRXhlY3V0ZVJlc3BvbnNlKHJlc3BvbnNlOiBhbnksIGNhbGxiYWNrOiAocmVzcG9uc2U6IGFueSkgPT4gdm9pZCk6IHZvaWQge1xyXG4gICAgICAgIHRoaXMudmFsaWRhdGVSZXNwb25zZShyZXNwb25zZSk7XHJcbiAgICAgICAgaWYgKGNhbGxiYWNrKSB7XHJcbiAgICAgICAgICAgIGNhbGxiYWNrKHJlc3BvbnNlKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSB2YWxpZGF0ZVJlc3BvbnNlKHJlc3BvbnNlOiBhbnkpOiB2b2lkIHtcclxuICAgICAgICBpZiAocmVzcG9uc2UuRXJyb3JPY3VycmVkKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IG1lc3NhZ2UgPSBgJHtyZXNwb25zZS5FeE1lc3NhZ2V9PHByZT4ke3Jlc3BvbnNlLkV4U3RhY2tUcmFjZX08cHJlXFw+YDtcclxuICAgICAgICAgICAgdGhyb3cgbmV3IE5ldHdvcmtFeGNlcHRpb24obWVzc2FnZSwgRXJyb3JDb2RlLlNlcnZlckVycm9yKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBzZW5kUmVxdWVzdCh1cmw6IHN0cmluZywgZGF0YTogYW55LCBjb25maWc/OiBJUmVxdWVzdENvbmZpZyk6IGFueSB7XHJcbiAgICAgICAgY29uZmlnID0gY29uZmlnIHx8IG5ldyBSZXF1ZXN0Q29uZmlnKCk7XHJcbiAgICAgICAgY29uZmlnLmNvbnRlbnRUeXBlID0gY29uZmlnLmNvbnRlbnRUeXBlIHx8IENvbnRlbnRUeXBlLmFwcGxpY2F0aW9uSnNvbjtcclxuXHJcbiAgICAgICAgaWYgKGNvbmZpZy5jb250ZW50VHlwZSAmJiBjb25maWcuY29udGVudFR5cGUgPT09IENvbnRlbnRUeXBlLm11bHRpcGFydEZvcm1kYXRhKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnByb2Nlc3NGb3JtRGF0YSh1cmwsIGRhdGEpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnByb2Nlc3NEZWZhdWx0KHVybCwgZGF0YSwgY29uZmlnKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBwcm9jZXNzRm9ybURhdGEodXJsOiBzdHJpbmcsIGRhdGE6IGFueSk6IGFueSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMubGlicmFyeS5xdWVyeS5hamF4KHVybCwge1xyXG4gICAgICAgICAgICBiZWZvcmVTZW5kOiAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmV2ZW50LnB1Ymxpc2goRXZlbnRzLkFjdGlvblNlbmRpbmcpO1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBjb250ZW50VHlwZTogZmFsc2UsXHJcbiAgICAgICAgICAgIGRhdGEsXHJcbiAgICAgICAgICAgIGhlYWRlcnM6IHsgV006IHRydWUgfSxcclxuICAgICAgICAgICAgcHJvY2Vzc0RhdGE6IGZhbHNlLFxyXG4gICAgICAgICAgICB0eXBlOiAnUE9TVCdcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIHByb2Nlc3NEZWZhdWx0KHVybDogc3RyaW5nLCBkYXRhOiBhbnksIGNvbmZpZzogSVJlcXVlc3RDb25maWcpOiBhbnkge1xyXG4gICAgICAgIC8vIGFkZCBXZWJNYXAgaGVhZGVyc1xyXG4gICAgICAgIGNvbmZpZy5oZWFkZXJzLldNID0gJ3RydWUnO1xyXG4gICAgICAgIHJldHVybiB0aGlzLmxpYnJhcnkucXVlcnkuYWpheCh1cmwsIHtcclxuICAgICAgICAgICAgYmVmb3JlU2VuZDogKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5ldmVudC5wdWJsaXNoKEV2ZW50cy5BY3Rpb25TZW5kaW5nKTtcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgY29udGVudFR5cGU6IGNvbmZpZy5jb250ZW50VHlwZSxcclxuICAgICAgICAgICAgZGF0YSxcclxuICAgICAgICAgICAgZGF0YVR5cGU6ICdqc29uJyxcclxuICAgICAgICAgICAgaGVhZGVyczogY29uZmlnLmhlYWRlcnMsXHJcbiAgICAgICAgICAgIHR5cGU6ICdQT1NUJ1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG59XHJcbiJdfQ==","map":null,"metadata":{},"sourceType":"module"}