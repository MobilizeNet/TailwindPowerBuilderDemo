{"ast":null,"code":"import { inArray, isFunction, isObject, valueOrDefault } from '../../common';\nconst MAX_EXPAND_DEPTH = 5;\nexport default function evalOptions(options, context, state = {}, dryRun = false) {\n  const defaults = state.defaults = state.defaults || {};\n  const depth = state.depth = state.depth || 0;\n  let needsEval = false;\n  state.excluded = state.excluded || [];\n\n  if (depth > MAX_EXPAND_DEPTH) {\n    return null;\n  }\n\n  for (let property in options) {\n    if (!inArray(property, state.excluded) && options.hasOwnProperty(property)) {\n      const propValue = options[property];\n\n      if (isFunction(propValue)) {\n        needsEval = true;\n\n        if (!dryRun) {\n          options[property] = valueOrDefault(propValue(context), defaults[property]);\n        }\n      } else if (isObject(propValue)) {\n        if (!dryRun) {\n          state.defaults = defaults[property];\n        }\n\n        state.depth++;\n        needsEval = evalOptions(propValue, context, state, dryRun) || needsEval;\n        state.depth--;\n      }\n    }\n  }\n\n  return needsEval;\n}","map":null,"metadata":{},"sourceType":"module"}