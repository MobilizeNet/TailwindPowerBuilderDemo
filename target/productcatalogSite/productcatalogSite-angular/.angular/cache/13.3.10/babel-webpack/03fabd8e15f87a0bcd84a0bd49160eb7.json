{"ast":null,"code":"var __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p];\n    };\n\n    return extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    if (typeof b !== \"function\" && b !== null) throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n    extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nvar __decorate = this && this.__decorate || function (decorators, target, key, desc) {\n  var c = arguments.length,\n      r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,\n      d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\n\nvar __metadata = this && this.__metadata || function (k, v) {\n  if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\n\nimport { Events } from '../../Contract';\nimport { ErrorCodes, ExceptionHandlerClass } from '../../System/Aop';\nimport { ViewManager } from '../../UI';\nimport { Commands } from '../../UI/Command';\nimport { ActionModelV5 } from '../Application';\nimport * as DOMPurify from 'dompurify';\n\nvar ViewManagerV5 = function (_super) {\n  __extends(ViewManagerV5, _super);\n\n  function ViewManagerV5(inject) {\n    if (inject === void 0) {\n      inject = null;\n    }\n\n    return _super.call(this, inject) || this;\n  }\n\n  ViewManagerV5.prototype.removeViews = function (viewIds) {\n    if (!viewIds) {\n      return;\n    }\n\n    for (var _i = 0, viewIds_1 = viewIds; _i < viewIds_1.length; _i++) {\n      var id = viewIds_1[_i];\n      this.deleteView(id);\n      this.models.deleteCascade(id);\n    }\n  };\n\n  ViewManagerV5.prototype.createViews = function (viewIds) {\n    var _this = this;\n\n    if (!viewIds) {\n      return;\n    }\n\n    var views = new Array();\n\n    for (var _i = 0, viewIds_2 = viewIds; _i < viewIds_2.length; _i++) {\n      var id = viewIds_2[_i];\n      this.createNewView(id, views);\n    }\n\n    views.forEach(function (v) {\n      return _this.viewLoad(v, views);\n    });\n  };\n\n  ViewManagerV5.prototype.updateViews = function (viewIds) {\n    if (!viewIds) {\n      return;\n    }\n\n    for (var _i = 0, viewIds_3 = viewIds; _i < viewIds_3.length; _i++) {\n      var id = viewIds_3[_i];\n      this.updateView(id);\n    }\n  };\n\n  ViewManagerV5.prototype.createNewView = function (id, views) {\n    var _this = this;\n\n    var model = this.models.getModel(id);\n\n    if (!model) {\n      throw new TypeError('Cannot create view from null model');\n    }\n\n    if (this.getView(model) === undefined) {\n      this.viewResolver.resolve(model, function (view) {\n        views.push(view);\n\n        _this.viewCreated(view);\n      });\n    }\n  };\n\n  ViewManagerV5.prototype.getModel = function (key) {\n    return this.models.getModel(key);\n  };\n\n  ViewManagerV5.prototype.updateView = function (id) {\n    var view = this.views.value(id);\n\n    if (view) {\n      var model = this.models.getModel(id);\n\n      if (model['IsDisposed']) {\n        this.deleteView(id);\n        this.models.deleteCascade(id);\n        return;\n      }\n\n      if (model['Visible']) {\n        view.show();\n      } else {\n        view.hide();\n      }\n    }\n  };\n\n  ViewManagerV5.prototype.initializeCommand = function () {\n    var _this = this;\n\n    _super.prototype.initializeCommand.call(this);\n\n    this.registerCommand(Commands.OpenView, function (command) {\n      return _this.openViewCommandHandler(command);\n    });\n    this.registerCommand(Commands.SendCommand, function (command) {\n      return _this.sendCommandHandler(command);\n    });\n    this.registerCommand(Commands.PendingResponse, function (command) {\n      return _this.pendingResponseHandler(command);\n    });\n    this.registerCommand(Commands.BringToFrontCommand, function (command) {\n      return _this.bringToFrontHandler(command);\n    });\n    this.registerCommand(Commands.SessionExpiredCommand, function (command) {\n      return _this.sessionExpiredHandler(command);\n    });\n    this.registerCommand(Commands.ChangeMenuCommand, function (command) {\n      return _this.changeMenuHandler(command);\n    });\n    this.registerCommand(Commands.DownloadFileCommand, function (command) {\n      return _this.downloadFileHandler(command);\n    });\n    this.registerCommand(Commands.ArrangeWindowCommand, function (command) {\n      return _this.arrangeWindowHandler(command);\n    });\n    this.registerCommand(Commands.GridPrintCommand, function (command) {\n      return _this.gridPrintHandler(command);\n    });\n    this.registerCommand(Commands.StartEditCommand, function (command) {\n      return _this.startEditControlHandler(command);\n    });\n    this.registerCommand(Commands.StylesChangedCommand, function (command) {\n      return _this.stylesChangedHandler(command);\n    });\n    this.registerCommand(Commands.UpdateRangesCommand, function (command) {\n      return _this.updateRangesHandler(command);\n    });\n    this.registerCommand(Commands.ModalExecutionCommand, function (command) {\n      return _this.modalExecutionHandler(command);\n    });\n  };\n\n  ViewManagerV5.prototype.openViewCommandHandler = function (command) {\n    var _this = this;\n\n    var model = this.models.getModel(command.receiverId);\n\n    if (this.getView(model) === undefined) {\n      this.viewResolver.resolve(model, function (view) {\n        view.load();\n\n        _this.viewCreated(view);\n      });\n    }\n  };\n\n  ViewManagerV5.prototype.sendCommandHandler = function (command) {\n    var actionModel = new ActionModelV5(command.receiverId, command.serverEvent, command.sender.name, command.action, command.args, command.callback, command.highPriority);\n    this.action.send(actionModel);\n  };\n\n  ViewManagerV5.prototype.downloadFileHandler = function (command) {\n    var url = \"\" + window.location.href + command.downloadUrl;\n    var downloadLink = document.createElement('a');\n    downloadLink.setAttribute('download', command.key);\n    var safeUrlT = DOMPurify.sanitize(url, {\n      RETURN_DOM_FRAGMENT: true\n    });\n    downloadLink.setAttribute('href', safeUrlT.textContent);\n    downloadLink.click();\n  };\n\n  ViewManagerV5.prototype.pendingResponseHandler = function (command) {\n    var commandName = Commands.PendingResponse;\n    var actionModel = new ActionModelV5(command.receiverId, command.serverEvent, commandName, command.action, command.args);\n    actionModel.requestConfig.headers[command.action] = command.receiverId;\n    this.action.send(actionModel);\n  };\n\n  ViewManagerV5.prototype.bringToFrontHandler = function (command) {\n    var model = this.models.getModel(command.UniqueID);\n    var view = this.getView(model);\n\n    if (view !== undefined) {\n      view.bringToFront();\n    }\n  };\n\n  ViewManagerV5.prototype.sessionExpiredHandler = function (command) {\n    var modal = this.modalFactory.create('expired');\n    modal.show(command);\n  };\n\n  ViewManagerV5.prototype.gridPrintHandler = function (command) {\n    this.event.publish(Events.GridPrint, command);\n  };\n\n  ViewManagerV5.prototype.stylesChangedHandler = function (command) {\n    this.event.publish(Events.StylesChanged, command);\n  };\n\n  ViewManagerV5.prototype.updateRangesHandler = function (command) {\n    this.event.publish(Events.UpdateRanges, command);\n  };\n\n  ViewManagerV5.prototype.modalExecutionHandler = function (command) {\n    this.event.publish(Events.ModalExecution, command);\n  };\n\n  ViewManagerV5 = __decorate([ExceptionHandlerClass(ErrorCodes.ClientCore), __metadata(\"design:paramtypes\", [Object])], ViewManagerV5);\n  return ViewManagerV5;\n}(ViewManager);\n\nexport { ViewManagerV5 }; //# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiVmlld01hbmFnZXIuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi9zcmMvdjUvVUkvVmlld01hbmFnZXIudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBb0JBLE9BQU8sRUFBRSxNQUFNLEVBQXdDLE1BQU0sZ0JBQWdCLENBQUM7QUFDOUUsT0FBTyxFQUFFLFVBQVUsRUFBRSxxQkFBcUIsRUFBRSxNQUFNLGtCQUFrQixDQUFDO0FBQ3JFLE9BQU8sRUFBRSxXQUFXLEVBQUUsTUFBTSxVQUFVLENBQUM7QUFDdkMsT0FBTyxFQUFFLFFBQVEsRUFBYSxNQUFNLGtCQUFrQixDQUFDO0FBQ3ZELE9BQU8sRUFBRSxhQUFhLEVBQUUsTUFBTSxnQkFBZ0IsQ0FBQztBQVMvQyxPQUFPLEtBQUssU0FBUyxNQUFNLFdBQVcsQ0FBQztBQUd2QztJQUFtQyxpQ0FBVztJQUM1Qyx1QkFBWSxNQUFzQjtRQUF0Qix1QkFBQSxFQUFBLGFBQXNCO2VBQ2hDLGtCQUFNLE1BQU0sQ0FBQztJQUNmLENBQUM7SUFFRCxtQ0FBVyxHQUFYLFVBQVksT0FBc0I7UUFDaEMsSUFBSSxDQUFDLE9BQU8sRUFBRTtZQUNaLE9BQU87U0FDUjtRQUVELEtBQWlCLFVBQU8sRUFBUCxtQkFBTyxFQUFQLHFCQUFPLEVBQVAsSUFBTyxFQUFFO1lBQXJCLElBQU0sRUFBRSxnQkFBQTtZQUNYLElBQUksQ0FBQyxVQUFVLENBQUMsRUFBRSxDQUFDLENBQUM7WUFDcEIsSUFBSSxDQUFDLE1BQU0sQ0FBQyxhQUFhLENBQUMsRUFBRSxDQUFDLENBQUM7U0FDL0I7SUFDSCxDQUFDO0lBRUQsbUNBQVcsR0FBWCxVQUFZLE9BQXNCO1FBQWxDLGlCQVNDO1FBUkMsSUFBSSxDQUFDLE9BQU8sRUFBRTtZQUNaLE9BQU87U0FDUjtRQUNELElBQU0sS0FBSyxHQUFpQixJQUFJLEtBQUssRUFBUyxDQUFDO1FBQy9DLEtBQWlCLFVBQU8sRUFBUCxtQkFBTyxF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QWEiLCJzb3VyY2VzQ29udGVudCI6WyIvKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcclxuKiBDb3B5cmlnaHQgKEMpIE1vYmlsaXplLk5ldCA8aW5mb0Btb2JpbGl6ZS5uZXQ+IC0gQWxsIFJpZ2h0cyBSZXNlcnZlZFxyXG4qXHJcbiogVGhpcyBmaWxlIGlzIHBhcnQgb2YgdGhlIE1vYmlsaXplIEZyYW1ld29ya3MsIHdoaWNoIGlzXHJcbiogcHJvcHJpZXRhcnkgYW5kIGNvbmZpZGVudGlhbC5cclxuKlxyXG4qIE5PVElDRTogIEFsbCBpbmZvcm1hdGlvbiBjb250YWluZWQgaGVyZWluIGlzLCBhbmQgcmVtYWluc1xyXG4qIHRoZSBwcm9wZXJ0eSBvZiBNb2JpbGl6ZS5OZXQgQ29ycG9yYXRpb24uXHJcbiogVGhlIGludGVsbGVjdHVhbCBhbmQgdGVjaG5pY2FsIGNvbmNlcHRzIGNvbnRhaW5lZCBoZXJlaW4gYXJlXHJcbiogcHJvcHJpZXRhcnkgdG8gTW9iaWxpemUuTmV0IENvcnBvcmF0aW9uIGFuZCBtYXkgYmUgY292ZXJlZFxyXG4qIGJ5IFUuUy4gUGF0ZW50cywgYW5kIGFyZSBwcm90ZWN0ZWQgYnkgdHJhZGUgc2VjcmV0IG9yIGNvcHlyaWdodCBsYXcuXHJcbiogRGlzc2VtaW5hdGlvbiBvZiB0aGlzIGluZm9ybWF0aW9uIG9yIHJlcHJvZHVjdGlvbiBvZiB0aGlzIG1hdGVyaWFsXHJcbiogaXMgc3RyaWN0bHkgZm9yYmlkZGVuIHVubGVzcyBwcmlvciB3cml0dGVuIHBlcm1pc3Npb24gaXMgb2J0YWluZWRcclxuKiBmcm9tIE1vYmlsaXplLk5ldCBDb3Jwb3JhdGlvbi5cclxuKlxyXG4qIFRoaXMgZmlsZSBpcyBzdWJqZWN0IHRvIHRoZSB0ZXJtcyBhbmQgY29uZGl0aW9ucyBkZWZpbmVkIGluXHJcbiogZmlsZSAnTElDRU5TRS50eHQnLCB3aGljaCBpcyBwYXJ0IG9mIHRoaXMgc291cmNlIGNvZGUgcGFja2FnZS5cclxuKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXHJcbmltcG9ydCB7IE1vZGVsVjUgfSBmcm9tICcuLi9Db3JlL01vZGVsJztcclxuXHJcbmltcG9ydCB7IEV2ZW50cywgSUluamVjdCwgSU1vZGVsLCBJVmlldywgSVZpZXdNYW5hZ2VyIH0gZnJvbSAnLi4vLi4vQ29udHJhY3QnO1xyXG5pbXBvcnQgeyBFcnJvckNvZGVzLCBFeGNlcHRpb25IYW5kbGVyQ2xhc3MgfSBmcm9tICcuLi8uLi9TeXN0ZW0vQW9wJztcclxuaW1wb3J0IHsgVmlld01hbmFnZXIgfSBmcm9tICcuLi8uLi9VSSc7XHJcbmltcG9ydCB7IENvbW1hbmRzLCBTdGFydEVkaXQgfSBmcm9tICcuLi8uLi9VSS9Db21tYW5kJztcclxuaW1wb3J0IHsgQWN0aW9uTW9kZWxWNSB9IGZyb20gJy4uL0FwcGxpY2F0aW9uJztcclxuaW1wb3J0IHsgRG93bmxvYWRGaWxlQ29tbWFuZCB9IGZyb20gJy4uL1VJL0NvbW1hbmQvRG93bmxvYWRGaWxlJztcclxuaW1wb3J0IHsgTW9kYWxFeGVjdXRpb25Db21tYW5kLCBPcGVuVmlld1Y1LCBQZW5kaW5nUmVzcG9uc2UsIFNlbmRWNSwgU3R5bGVzQ2hhbmdlZENvbW1hbmQsIFVwZGF0ZVJhbmdlc0NvbW1hbmQgfSBmcm9tICcuL0NvbW1hbmQnO1xyXG5pbXBvcnQgeyBBcnJhbmdlV2luZG93Q29tbWFuZFY1IH0gZnJvbSAnLi9Db21tYW5kL0FycmFuZ2VXaW5kb3dDb21tYW5kVjUnO1xyXG5pbXBvcnQgeyBCcmluZ1RvRnJvbnQgfSBmcm9tICcuL0NvbW1hbmQvQnJpbmdUb0Zyb250JztcclxuaW1wb3J0IHsgQ2hhbmdlTWVudVY1IH0gZnJvbSAnLi9Db21tYW5kL0NoYW5nZU1lbnVWNSc7XHJcbmltcG9ydCB7IEdyaWRQcmludENvbW1hbmQgfSBmcm9tICcuL0NvbW1hbmQvR3JpZFByaW50Q29tbWFuZCc7XHJcbmltcG9ydCB7IFNlc3Npb25FeHBpcmVkQ29tbWFuZCB9IGZyb20gJy4vQ29tbWFuZC9TZXNzaW9uRXhwaXJlZCc7XHJcblxyXG5pbXBvcnQgKiBhcyBET01QdXJpZnkgZnJvbSAnZG9tcHVyaWZ5JztcclxuXHJcbkBFeGNlcHRpb25IYW5kbGVyQ2xhc3MoRXJyb3JDb2Rlcy5DbGllbnRDb3JlKVxyXG5leHBvcnQgY2xhc3MgVmlld01hbmFnZXJWNSBleHRlbmRzIFZpZXdNYW5hZ2VyIGltcGxlbWVudHMgSVZpZXdNYW5hZ2VyIHtcclxuICBjb25zdHJ1Y3RvcihpbmplY3Q6IElJbmplY3QgPSBudWxsKSB7XHJcbiAgICBzdXBlcihpbmplY3QpO1xyXG4gIH1cclxuXHJcbiAgcmVtb3ZlVmlld3Modmlld0lkczogQXJyYXk8c3RyaW5nPik6IHZvaWQge1xyXG4gICAgaWYgKCF2aWV3SWRzKSB7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuXHJcbiAgICBmb3IgKGNvbnN0IGlkIG9mIHZpZXdJZHMpIHtcclxuICAgICAgdGhpcy5kZWxldGVWaWV3KGlkKTtcclxuICAgICAgdGhpcy5tb2RlbHMuZGVsZXRlQ2FzY2FkZShpZCk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBjcmVhdGVWaWV3cyh2aWV3SWRzOiBBcnJheTxzdHJpbmc+KTogdm9pZCB7XHJcbiAgICBpZiAoIXZpZXdJZHMpIHtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgY29uc3Qgdmlld3M6IEFycmF5PElWaWV3PiA9IG5ldyBBcnJheTxJVmlldz4oKTtcclxuICAgIGZvciAoY29uc3QgaWQgb2Ygdmlld0lkcykge1xyXG4gICAgICB0aGlzLmNyZWF0ZU5ld1ZpZXcoaWQsIHZpZXdzKTtcclxuICAgIH1cclxuICAgIHZpZXdzLmZvckVhY2godiA9PiB0aGlzLnZpZXdMb2FkKHYsIHZpZXdzKSk7XHJcbiAgfVxyXG5cclxuICB1cGRhdGVWaWV3cyh2aWV3SWRzOiBBcnJheTxzdHJpbmc+KTogdm9pZCB7XHJcbiAgICBpZiAoIXZpZXdJZHMpIHtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG5cclxuICAgIGZvciAoY29uc3QgaWQgb2Ygdmlld0lkcykge1xyXG4gICAgICB0aGlzLnVwZGF0ZVZpZXcoaWQpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgY3JlYXRlTmV3VmlldyhpZDogc3RyaW5nLCB2aWV3czogQXJyYXk8SVZpZXc+KTogdm9pZCB7XHJcbiAgICBjb25zdCBtb2RlbCA9IHRoaXMubW9kZWxzLmdldE1vZGVsKGlkKTtcclxuICAgIC8qIGM4IGlnbm9yZSBuZXh0IDMgKi9cclxuICAgIGlmICghbW9kZWwpIHtcclxuICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignQ2Fubm90IGNyZWF0ZSB2aWV3IGZyb20gbnVsbCBtb2RlbCcpO1xyXG4gICAgfVxyXG4gICAgaWYgKHRoaXMuZ2V0Vmlldyhtb2RlbCkgPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICB0aGlzLnZpZXdSZXNvbHZlci5yZXNvbHZlKG1vZGVsLCB2aWV3ID0+IHtcclxuICAgICAgICB2aWV3cy5wdXNoKHZpZXcpO1xyXG4gICAgICAgIHRoaXMudmlld0NyZWF0ZWQodmlldyk7XHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgZ2V0TW9kZWwoa2V5OiBzdHJpbmcpOiBJTW9kZWwge1xyXG4gICAgcmV0dXJuIHRoaXMubW9kZWxzLmdldE1vZGVsKGtleSk7XHJcbiAgfVxyXG5cclxuICBwcm90ZWN0ZWQgdXBkYXRlVmlldyhpZDogc3RyaW5nKTogdm9pZCB7XHJcbiAgICBjb25zdCB2aWV3ID0gdGhpcy52aWV3cy52YWx1ZShpZCk7XHJcbiAgICBpZiAodmlldykge1xyXG4gICAgICBjb25zdCBtb2RlbCA9IHRoaXMubW9kZWxzLmdldE1vZGVsKGlkKTtcclxuICAgICAgaWYgKG1vZGVsWydJc0Rpc3Bvc2VkJ10pIHtcclxuICAgICAgICB0aGlzLmRlbGV0ZVZpZXcoaWQpO1xyXG4gICAgICAgIHRoaXMubW9kZWxzLmRlbGV0ZUNhc2NhZGUoaWQpO1xyXG4gICAgICAgIHJldHVybjtcclxuICAgICAgfVxyXG4gICAgICAvLyBUT0RPOiB1cGRhdGUgdGhlIHdheSB0byBmaW5kIHRoaXMgcHJvcGVydHlcclxuICAgICAgaWYgKG1vZGVsWydWaXNpYmxlJ10pIHtcclxuICAgICAgICB2aWV3LnNob3coKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICB2aWV3LmhpZGUoKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcHJvdGVjdGVkIGluaXRpYWxpemVDb21tYW5kKCk6IHZvaWQge1xyXG4gICAgc3VwZXIuaW5pdGlhbGl6ZUNvbW1hbmQoKTtcclxuICAgIHRoaXMucmVnaXN0ZXJDb21tYW5kKENvbW1hbmRzLk9wZW5WaWV3LCBjb21tYW5kID0+XHJcbiAgICAgIHRoaXMub3BlblZpZXdDb21tYW5kSGFuZGxlcihjb21tYW5kIGFzIE9wZW5WaWV3VjUpXHJcbiAgICApO1xyXG4gICAgdGhpcy5yZWdpc3RlckNvbW1hbmQoQ29tbWFuZHMuU2VuZENvbW1hbmQsIGNvbW1hbmQgPT5cclxuICAgICAgdGhpcy5zZW5kQ29tbWFuZEhhbmRsZXIoY29tbWFuZCBhcyBTZW5kVjUpXHJcbiAgICApO1xyXG4gICAgdGhpcy5yZWdpc3RlckNvbW1hbmQoQ29tbWFuZHMuUGVuZGluZ1Jlc3BvbnNlLCBjb21tYW5kID0+XHJcbiAgICAgIHRoaXMucGVuZGluZ1Jlc3BvbnNlSGFuZGxlcihjb21tYW5kIGFzIFBlbmRpbmdSZXNwb25zZSlcclxuICAgICk7XHJcbiAgICB0aGlzLnJlZ2lzdGVyQ29tbWFuZChDb21tYW5kcy5CcmluZ1RvRnJvbnRDb21tYW5kLCBjb21tYW5kID0+XHJcbiAgICAgIHRoaXMuYnJpbmdUb0Zyb250SGFuZGxlcihjb21tYW5kIGFzIEJyaW5nVG9Gcm9udClcclxuICAgICk7XHJcbiAgICB0aGlzLnJlZ2lzdGVyQ29tbWFuZChDb21tYW5kcy5TZXNzaW9uRXhwaXJlZENvbW1hbmQsIGNvbW1hbmQgPT5cclxuICAgICAgdGhpcy5zZXNzaW9uRXhwaXJlZEhhbmRsZXIoY29tbWFuZCBhcyBTZXNzaW9uRXhwaXJlZENvbW1hbmQpXHJcbiAgICApO1xyXG4gICAgdGhpcy5yZWdpc3RlckNvbW1hbmQoQ29tbWFuZHMuQ2hhbmdlTWVudUNvbW1hbmQsIGNvbW1hbmQgPT5cclxuICAgICAgdGhpcy5jaGFuZ2VNZW51SGFuZGxlcihjb21tYW5kIGFzIENoYW5nZU1lbnVWNSlcclxuICAgICk7XHJcbiAgICB0aGlzLnJlZ2lzdGVyQ29tbWFuZChDb21tYW5kcy5Eb3dubG9hZEZpbGVDb21tYW5kLCBjb21tYW5kID0+XHJcbiAgICAgIHRoaXMuZG93bmxvYWRGaWxlSGFuZGxlcihjb21tYW5kIGFzIERvd25sb2FkRmlsZUNvbW1hbmQpXHJcbiAgICApO1xyXG4gICAgdGhpcy5yZWdpc3RlckNvbW1hbmQoQ29tbWFuZHMuQXJyYW5nZVdpbmRvd0NvbW1hbmQsIGNvbW1hbmQgPT5cclxuICAgICAgdGhpcy5hcnJhbmdlV2luZG93SGFuZGxlcihjb21tYW5kIGFzIEFycmFuZ2VXaW5kb3dDb21tYW5kVjUpXHJcbiAgICApO1xyXG4gICAgdGhpcy5yZWdpc3RlckNvbW1hbmQoQ29tbWFuZHMuR3JpZFByaW50Q29tbWFuZCwgY29tbWFuZCA9PlxyXG4gICAgICB0aGlzLmdyaWRQcmludEhhbmRsZXIoY29tbWFuZCBhcyBHcmlkUHJpbnRDb21tYW5kKVxyXG4gICAgKTtcclxuICAgIHRoaXMucmVnaXN0ZXJDb21tYW5kKENvbW1hbmRzLlN0YXJ0RWRpdENvbW1hbmQsIGNvbW1hbmQgPT5cclxuICAgICAgdGhpcy5zdGFydEVkaXRDb250cm9sSGFuZGxlcihjb21tYW5kIGFzIFN0YXJ0RWRpdClcclxuICAgICk7XHJcbiAgICB0aGlzLnJlZ2lzdGVyQ29tbWFuZChDb21tYW5kcy5TdHlsZXNDaGFuZ2VkQ29tbWFuZCwgY29tbWFuZCA9PlxyXG4gICAgICB0aGlzLnN0eWxlc0NoYW5nZWRIYW5kbGVyKGNvbW1hbmQgYXMgU3R5bGVzQ2hhbmdlZENvbW1hbmQpXHJcbiAgICApO1xyXG4gICAgdGhpcy5yZWdpc3RlckNvbW1hbmQoQ29tbWFuZHMuVXBkYXRlUmFuZ2VzQ29tbWFuZCwgY29tbWFuZCA9PlxyXG4gICAgICB0aGlzLnVwZGF0ZVJhbmdlc0hhbmRsZXIoY29tbWFuZCBhcyBVcGRhdGVSYW5nZXNDb21tYW5kKVxyXG4gICAgKTtcclxuICAgIHRoaXMucmVnaXN0ZXJDb21tYW5kKENvbW1hbmRzLk1vZGFsRXhlY3V0aW9uQ29tbWFuZCwgY29tbWFuZCA9PlxyXG4gICAgICB0aGlzLm1vZGFsRXhlY3V0aW9uSGFuZGxlcihjb21tYW5kIGFzIE1vZGFsRXhlY3V0aW9uQ29tbWFuZClcclxuICAgICk7XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIG9wZW5WaWV3Q29tbWFuZEhhbmRsZXIoY29tbWFuZDogT3BlblZpZXdWNSk6IHZvaWQge1xyXG4gICAgY29uc3QgbW9kZWwgPSB0aGlzLm1vZGVscy5nZXRNb2RlbChjb21tYW5kLnJlY2VpdmVySWQpO1xyXG4gICAgaWYgKHRoaXMuZ2V0Vmlldyhtb2RlbCkgPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICB0aGlzLnZpZXdSZXNvbHZlci5yZXNvbHZlKG1vZGVsLCB2aWV3ID0+IHtcclxuICAgICAgICB2aWV3LmxvYWQoKTtcclxuICAgICAgICB0aGlzLnZpZXdDcmVhdGVkKHZpZXcpO1xyXG4gICAgICB9KTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHByaXZhdGUgc2VuZENvbW1hbmRIYW5kbGVyKGNvbW1hbmQ6IFNlbmRWNSk6IHZvaWQge1xyXG4gICAgY29uc3QgYWN0aW9uTW9kZWwgPSBuZXcgQWN0aW9uTW9kZWxWNShcclxuICAgICAgY29tbWFuZC5yZWNlaXZlcklkLFxyXG4gICAgICBjb21tYW5kLnNlcnZlckV2ZW50LFxyXG4gICAgICBjb21tYW5kLnNlbmRlci5uYW1lLFxyXG4gICAgICBjb21tYW5kLmFjdGlvbixcclxuICAgICAgY29tbWFuZC5hcmdzLFxyXG4gICAgICBjb21tYW5kLmNhbGxiYWNrLFxyXG4gICAgICBjb21tYW5kLmhpZ2hQcmlvcml0eSk7XHJcbiAgICB0aGlzLmFjdGlvbi5zZW5kKGFjdGlvbk1vZGVsKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIERvd25sb2FkIGZpbGUgYW5kIFNhbml0aXplIHVybCB2YWx1ZSB0byBwcmV2ZW50IGNyb3NzU2NyaXB0aW5nXHJcbiAgICpcclxuICAgKiBAcHJpdmF0ZVxyXG4gICAqIEBwYXJhbSB7RG93bmxvYWRGaWxlQ29tbWFuZH0gY29tbWFuZFxyXG4gICAqIEBtZW1iZXJvZiBWaWV3TWFuYWdlclY1XHJcbiAgICovXHJcbiAgcHJpdmF0ZSBkb3dubG9hZEZpbGVIYW5kbGVyKGNvbW1hbmQ6IERvd25sb2FkRmlsZUNvbW1hbmQpOiB2b2lkIHtcclxuICAgIGNvbnN0IHVybCA9IGAke3dpbmRvdy5sb2NhdGlvbi5ocmVmfSR7Y29tbWFuZC5kb3dubG9hZFVybH1gO1xyXG4gICAgY29uc3QgZG93bmxvYWRMaW5rID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYScpO1xyXG4gICAgZG93bmxvYWRMaW5rLnNldEF0dHJpYnV0ZSgnZG93bmxvYWQnLCBjb21tYW5kLmtleSk7XHJcbiAgICBjb25zdCBzYWZlVXJsVCA9IERPTVB1cmlmeS5zYW5pdGl6ZSh1cmwsIHtSRVRVUk5fRE9NX0ZSQUdNRU5UOiB0cnVlfSk7XHJcbiAgICBkb3dubG9hZExpbmsuc2V0QXR0cmlidXRlKCdocmVmJywgc2FmZVVybFQudGV4dENvbnRlbnQpO1xyXG4gICAgZG93bmxvYWRMaW5rLmNsaWNrKCk7XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIHBlbmRpbmdSZXNwb25zZUhhbmRsZXIoY29tbWFuZDogUGVuZGluZ1Jlc3BvbnNlKTogdm9pZCB7XHJcbiAgICBjb25zdCBjb21tYW5kTmFtZSA9IENvbW1hbmRzLlBlbmRpbmdSZXNwb25zZTtcclxuICAgIGNvbnN0IGFjdGlvbk1vZGVsID0gbmV3IEFjdGlvbk1vZGVsVjUoY29tbWFuZC5yZWNlaXZlcklkLCBjb21tYW5kLnNlcnZlckV2ZW50LCBjb21tYW5kTmFtZSwgY29tbWFuZC5hY3Rpb24sIGNvbW1hbmQuYXJncyk7XHJcbiAgICBhY3Rpb25Nb2RlbC5yZXF1ZXN0Q29uZmlnLmhlYWRlcnNbY29tbWFuZC5hY3Rpb25dID0gY29tbWFuZC5yZWNlaXZlcklkO1xyXG4gICAgdGhpcy5hY3Rpb24uc2VuZChhY3Rpb25Nb2RlbCk7XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGJyaW5nVG9Gcm9udEhhbmRsZXIoY29tbWFuZDogQnJpbmdUb0Zyb250KTogdm9pZCB7XHJcbiAgICBjb25zdCBtb2RlbCA9IHRoaXMubW9kZWxzLmdldE1vZGVsKGNvbW1hbmQuVW5pcXVlSUQpIGFzIE1vZGVsVjU7XHJcbiAgICBjb25zdCB2aWV3ID0gdGhpcy5nZXRWaWV3KG1vZGVsKTtcclxuICAgIGlmICh2aWV3ICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgdmlldy5icmluZ1RvRnJvbnQoKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHByaXZhdGUgc2Vzc2lvbkV4cGlyZWRIYW5kbGVyKGNvbW1hbmQ6IFNlc3Npb25FeHBpcmVkQ29tbWFuZCk6IHZvaWQge1xyXG4gICAgY29uc3QgbW9kYWwgPSB0aGlzLm1vZGFsRmFjdG9yeS5jcmVhdGUoJ2V4cGlyZWQnKTtcclxuICAgIG1vZGFsLnNob3coY29tbWFuZCk7XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGdyaWRQcmludEhhbmRsZXIoY29tbWFuZDogR3JpZFByaW50Q29tbWFuZCk6IHZvaWQge1xyXG4gICAgdGhpcy5ldmVudC5wdWJsaXNoKEV2ZW50cy5HcmlkUHJpbnQsIGNvbW1hbmQpO1xyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBzdHlsZXNDaGFuZ2VkSGFuZGxlcihjb21tYW5kOiBTdHlsZXNDaGFuZ2VkQ29tbWFuZCk6IHZvaWQge1xyXG4gICAgdGhpcy5ldmVudC5wdWJsaXNoKEV2ZW50cy5TdHlsZXNDaGFuZ2VkLCBjb21tYW5kKTtcclxuICB9XHJcblxyXG4gIHByaXZhdGUgdXBkYXRlUmFuZ2VzSGFuZGxlcihjb21tYW5kOiBVcGRhdGVSYW5nZXNDb21tYW5kKTogdm9pZCB7XHJcbiAgICB0aGlzLmV2ZW50LnB1Ymxpc2goRXZlbnRzLlVwZGF0ZVJhbmdlcywgY29tbWFuZCk7XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIG1vZGFsRXhlY3V0aW9uSGFuZGxlcihjb21tYW5kOiBNb2RhbEV4ZWN1dGlvbkNvbW1hbmQpOiB2b2lkIHtcclxuICAgIHRoaXMuZXZlbnQucHVibGlzaChFdmVudHMuTW9kYWxFeGVjdXRpb24sIGNvbW1hbmQpO1xyXG4gIH1cclxufVxyXG4iXX0=","map":null,"metadata":{},"sourceType":"module"}