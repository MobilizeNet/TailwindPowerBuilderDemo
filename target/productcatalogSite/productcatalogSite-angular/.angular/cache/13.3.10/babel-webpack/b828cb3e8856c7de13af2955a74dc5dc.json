{"ast":null,"code":"import { drawing as draw, geometry as geom } from '@progress/kendo-drawing';\nimport { ChartElement, CategoryAxis } from '../../core';\nimport CrosshairTooltip from './crosshair-tooltip';\nimport { BLACK, X, Y } from '../../common/constants';\nimport { deepExtend, setDefaultOptions } from '../../common';\n\nclass Crosshair extends ChartElement {\n  constructor(chartService, axis, options) {\n    super(options);\n    this.axis = axis;\n    this.stickyMode = axis instanceof CategoryAxis;\n    const tooltipOptions = this.options.tooltip;\n\n    if (tooltipOptions.visible) {\n      this.tooltip = new CrosshairTooltip(chartService, this, deepExtend({}, tooltipOptions, {\n        stickyMode: this.stickyMode\n      }));\n    }\n  }\n\n  showAt(point) {\n    this.point = point;\n    this.moveLine();\n    this.line.visible(true);\n\n    if (this.tooltip) {\n      this.tooltip.showAt(point);\n    }\n  }\n\n  hide() {\n    this.line.visible(false);\n\n    if (this.tooltip) {\n      this.tooltip.hide();\n    }\n  }\n\n  moveLine() {\n    const {\n      axis,\n      point\n    } = this;\n    const vertical = axis.options.vertical;\n    const box = this.getBox();\n    const dim = vertical ? Y : X;\n    const lineStart = new geom.Point(box.x1, box.y1);\n    let lineEnd;\n\n    if (vertical) {\n      lineEnd = new geom.Point(box.x2, box.y1);\n    } else {\n      lineEnd = new geom.Point(box.x1, box.y2);\n    }\n\n    if (point) {\n      if (this.stickyMode) {\n        const slot = axis.getSlot(axis.pointCategoryIndex(point));\n        lineStart[dim] = lineEnd[dim] = slot.center()[dim];\n      } else {\n        lineStart[dim] = lineEnd[dim] = point[dim];\n      }\n    }\n\n    this.box = box;\n    this.line.moveTo(lineStart).lineTo(lineEnd);\n  }\n\n  getBox() {\n    const axis = this.axis;\n    const axes = axis.pane.axes;\n    const length = axes.length;\n    const vertical = axis.options.vertical;\n    const box = axis.lineBox().clone();\n    const dim = vertical ? X : Y;\n    let axisLineBox;\n\n    for (let i = 0; i < length; i++) {\n      const currentAxis = axes[i];\n\n      if (currentAxis.options.vertical !== vertical) {\n        if (!axisLineBox) {\n          axisLineBox = currentAxis.lineBox().clone();\n        } else {\n          axisLineBox.wrap(currentAxis.lineBox());\n        }\n      }\n    }\n\n    box[dim + 1] = axisLineBox[dim + 1];\n    box[dim + 2] = axisLineBox[dim + 2];\n    return box;\n  }\n\n  createVisual() {\n    super.createVisual();\n    const options = this.options;\n    this.line = new draw.Path({\n      stroke: {\n        color: options.color,\n        width: options.width,\n        opacity: options.opacity,\n        dashType: options.dashType\n      },\n      visible: false\n    });\n    this.moveLine();\n    this.visual.append(this.line);\n  }\n\n  destroy() {\n    if (this.tooltip) {\n      this.tooltip.destroy();\n    }\n\n    super.destroy();\n  }\n\n}\n\nsetDefaultOptions(Crosshair, {\n  color: BLACK,\n  width: 2,\n  zIndex: -1,\n  tooltip: {\n    visible: false\n  }\n});\nexport default Crosshair;","map":null,"metadata":{},"sourceType":"module"}