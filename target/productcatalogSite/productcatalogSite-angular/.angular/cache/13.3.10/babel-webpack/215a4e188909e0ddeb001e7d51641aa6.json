{"ast":null,"code":"import { Encoding } from './encoding';\nimport { setDefaultOptions } from '../../common';\nconst extend = Object.assign;\nexport class Code11 extends Encoding {\n  initProperties() {\n    super.initProperties();\n    extend(this, {\n      name: \"Code 11\",\n      characterMap: [\"111121\", \"211121\", \"121121\", \"221111\", \"112121\", \"212111\", \"122111\", \"111221\", \"211211\", \"211111\", \"112111\"],\n      cCheckSumTotal: 10,\n      kCheckSumTotal: 9,\n      kCheckSumMinLength: 10,\n      checkSumMod: 11,\n      DASH_VALUE: 10,\n      DASH: \"-\",\n      START: \"112211\",\n      STOP: \"11221\"\n    });\n  }\n\n  initValue(value, width) {\n    this.pattern = [];\n    this.value = value;\n    this.width = width;\n    this.totalUnits = 0;\n  }\n\n  addData() {\n    const value = this.value;\n    this.addPattern(this.START);\n\n    for (let i = 0; i < value.length; i++) {\n      this.addCharacter(value.charAt(i));\n    }\n\n    if (this.options.addCheckSum) {\n      this.addCheckSum();\n    }\n\n    this.addPattern(this.STOP);\n    this.setBaseUnit();\n  }\n\n  setBaseUnit() {\n    this.baseUnit = this.width / (this.totalUnits + this.quietZoneLength);\n  }\n\n  addCheckSum() {\n    const value = this.value;\n    let length = value.length;\n    const cValue = this.getWeightedSum(value, length, this.cCheckSumTotal) % this.checkSumMod;\n    this.checksum = String(cValue);\n    this.addPattern(this.characterMap[cValue]);\n    length++;\n\n    if (length >= this.kCheckSumMinLength) {\n      let kValue = (cValue + this.getWeightedSum(value, length, this.kCheckSumTotal)) % this.checkSumMod;\n      this.checksum += kValue;\n      this.addPattern(this.characterMap[kValue]);\n    }\n  }\n\n  getWeightedSum(value, length, total) {\n    let weightedSum = 0;\n\n    for (let i = 0; i < value.length; i++) {\n      weightedSum += this.weightedValue(this.getValue(value.charAt(i)), length, i, total);\n    }\n\n    return weightedSum;\n  }\n\n  weightedValue(value, length, index, total) {\n    const weight = (length - index) % total || total;\n    return weight * value;\n  }\n\n  getValue(character) {\n    if (!isNaN(character)) {\n      return parseInt(character, 10);\n    } else if (character !== this.DASH) {\n      this.invalidCharacterError(character);\n    }\n\n    return this.DASH_VALUE;\n  }\n\n  addCharacter(character) {\n    const value = this.getValue(character);\n    const pattern = this.characterMap[value];\n    this.addPattern(pattern);\n  }\n\n  addPattern(pattern) {\n    let value;\n\n    for (let i = 0; i < pattern.length; i++) {\n      value = parseInt(pattern.charAt(i), 10);\n      this.pattern.push(value);\n      this.totalUnits += value;\n    }\n  }\n\n}\nsetDefaultOptions(Code11, {\n  addCheckSum: true\n});","map":null,"metadata":{},"sourceType":"module"}