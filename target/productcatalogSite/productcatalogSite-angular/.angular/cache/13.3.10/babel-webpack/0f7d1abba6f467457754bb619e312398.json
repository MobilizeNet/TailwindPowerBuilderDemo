{"ast":null,"code":"import { drawing as draw } from '@progress/kendo-drawing';\nimport Target from './target';\nimport { Box, ChartElement } from '../../core';\nimport PointEventsMixin from '../mixins/point-events-mixin';\nimport NoteMixin from '../mixins/note-mixin';\nimport Bar from '../bar-chart/bar';\nimport { WHITE, TOP, RIGHT } from '../../common/constants';\nimport { alignPathToPixel, deepExtend, defined, getTemplate, setDefaultOptions, valueOrDefault } from '../../common';\nimport BarLabel from '../bar-chart/bar-label';\n\nclass Bullet extends ChartElement {\n  constructor(value, options) {\n    super(options);\n    this.aboveAxis = this.options.aboveAxis;\n    this.color = options.color || WHITE;\n    this.value = value;\n  }\n\n  render() {\n    const options = this.options;\n\n    if (!this._rendered) {\n      this._rendered = true;\n\n      if (defined(this.value.target)) {\n        this.target = new Target({\n          type: options.target.shape,\n          background: options.target.color || this.color,\n          opacity: options.opacity,\n          zIndex: options.zIndex,\n          border: options.target.border,\n          vAlign: TOP,\n          align: RIGHT\n        });\n        this.target.value = this.value;\n        this.target.dataItem = this.dataItem;\n        this.target.series = this.series;\n        this.append(this.target);\n      }\n\n      this.createLabel();\n      this.createNote();\n    }\n  }\n\n  createLabel() {\n    const options = this.options;\n    const labels = options.labels;\n\n    if (labels.visible) {\n      const pointData = this.pointData();\n      let labelTemplate = getTemplate(labels);\n      let labelText;\n\n      if (labelTemplate) {\n        labelText = labelTemplate(pointData);\n      } else {\n        labelText = this.formatValue(labels.format);\n      }\n\n      this.label = new BarLabel(labelText, labels, pointData);\n      this.append(this.label);\n    }\n  }\n\n  reflow(box) {\n    this.render();\n    const {\n      options,\n      target,\n      owner: chart\n    } = this;\n    const invertAxes = options.invertAxes;\n    const valueAxis = chart.seriesValueAxis(this.options);\n    const categorySlot = chart.categorySlot(chart.categoryAxis, options.categoryIx, valueAxis);\n    const targetValueSlot = valueAxis.getSlot(this.value.target);\n    const targetSlotX = invertAxes ? targetValueSlot : categorySlot;\n    const targetSlotY = invertAxes ? categorySlot : targetValueSlot;\n\n    if (target) {\n      const targetSlot = new Box(targetSlotX.x1, targetSlotY.y1, targetSlotX.x2, targetSlotY.y2);\n      target.options.height = invertAxes ? targetSlot.height() : options.target.line.width;\n      target.options.width = invertAxes ? options.target.line.width : targetSlot.width();\n      target.reflow(targetSlot);\n    }\n\n    const label = this.label;\n\n    if (label) {\n      label.options.aboveAxis = this.aboveAxis;\n      label.reflow(box);\n    }\n\n    if (this.note) {\n      this.note.reflow(box);\n    }\n\n    this.box = box;\n  }\n\n  createVisual() {\n    super.createVisual();\n    const options = this.options;\n    const body = draw.Path.fromRect(this.box.toRect(), {\n      fill: {\n        color: this.color,\n        opacity: options.opacity\n      },\n      stroke: null\n    });\n\n    if (options.border.width > 0) {\n      body.options.set(\"stroke\", {\n        color: options.border.color || this.color,\n        width: options.border.width,\n        dashType: options.border.dashType,\n        opacity: valueOrDefault(options.border.opacity, options.opacity)\n      });\n    }\n\n    this.bodyVisual = body;\n    alignPathToPixel(body);\n    this.visual.append(body);\n  }\n\n  createAnimation() {\n    if (this.bodyVisual) {\n      this.animation = draw.Animation.create(this.bodyVisual, this.options.animation);\n    }\n  }\n\n  createHighlight(style) {\n    return draw.Path.fromRect(this.box.toRect(), style);\n  }\n\n  highlightVisual() {\n    return this.bodyVisual;\n  }\n\n  highlightVisualArgs() {\n    return {\n      rect: this.box.toRect(),\n      visual: this.bodyVisual,\n      options: this.options\n    };\n  }\n\n  formatValue(format) {\n    return this.owner.formatPointValue(this, format);\n  }\n\n  pointData() {\n    return {\n      dataItem: this.dataItem,\n      category: this.category,\n      value: this.value,\n      series: this.series\n    };\n  }\n\n  overlapsBox(box) {\n    return this.box.overlaps(box);\n  }\n\n}\n\nBullet.prototype.tooltipAnchor = Bar.prototype.tooltipAnchor;\nsetDefaultOptions(Bullet, {\n  border: {\n    width: 1\n  },\n  vertical: false,\n  opacity: 1,\n  target: {\n    shape: \"\",\n    border: {\n      width: 0,\n      color: \"green\"\n    },\n    line: {\n      width: 2\n    }\n  },\n  labels: {\n    visible: false\n  },\n  tooltip: {\n    format: \"Current: {0}<br />Target: {1}\"\n  },\n  notes: {\n    label: {}\n  }\n});\ndeepExtend(Bullet.prototype, PointEventsMixin);\ndeepExtend(Bullet.prototype, NoteMixin);\nexport default Bullet;","map":null,"metadata":{},"sourceType":"module"}