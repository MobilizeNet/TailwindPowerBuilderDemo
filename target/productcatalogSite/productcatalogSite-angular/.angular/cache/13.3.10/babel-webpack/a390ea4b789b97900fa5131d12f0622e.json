{"ast":null,"code":"var __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p];\n    };\n\n    return extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    if (typeof b !== \"function\" && b !== null) throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n    extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nvar __decorate = this && this.__decorate || function (decorators, target, key, desc) {\n  var c = arguments.length,\n      r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,\n      d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\n\nvar __metadata = this && this.__metadata || function (k, v) {\n  if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\n\nimport { Model } from '../../Core';\nimport { ErrorCodes, ExceptionHandlerClass } from '../../System/Aop';\n\nvar ModelV5 = function (_super) {\n  __extends(ModelV5, _super);\n\n  function ModelV5(id, projection) {\n    var _this = _super.call(this, id) || this;\n\n    _this.___init(id, projection);\n\n    return _this;\n  }\n\n  ModelV5_1 = ModelV5;\n  Object.defineProperty(ModelV5.prototype, \"UniqueID\", {\n    get: function () {\n      return this.id;\n    },\n    set: function (value) {\n      this.id = value;\n    },\n    enumerable: false,\n    configurable: true\n  });\n\n  ModelV5.prototype.___init = function (id, projection) {\n    this.id = id;\n    this.references = {};\n    this.referencedBy = {};\n\n    if (projection) {\n      this.references = projection.References ? projection.References : {};\n      this.mapperId = projection.MapperId;\n      this.eventChanges = projection.EventChanges ? projection.EventChanges : {};\n      this.stylePivot = projection.Style ? projection.Style : {};\n    }\n\n    this.addProperties(projection);\n  };\n\n  ModelV5.prototype.addReferencedBy = function (modelId, name) {\n    this.referencedBy[modelId] = name;\n  };\n\n  ModelV5.prototype.removeReference = function (name) {\n    delete this.references[name];\n    delete this[name];\n  };\n\n  ModelV5.prototype.applyOnProperties = function (item, fn) {\n    for (var prop in item) {\n      if (item.hasOwnProperty(prop) && ModelV5_1.myInternalProperties.indexOf(prop) === -1) {\n        fn.call(this, prop);\n      } else if (prop === ModelV5_1.myInternalProperties[2]) {\n        this.applyReferencesDeltas(item);\n      }\n    }\n  };\n\n  ModelV5.prototype.applyReferencesDeltas = function (projection) {\n    for (var ref in projection.References) {\n      if (projection.References.hasOwnProperty(ref)) {\n        this.references[ref] = projection.References[ref];\n      }\n    }\n  };\n\n  ModelV5.prototype.addProperties = function (obj) {\n    for (var key in obj) {\n      if (obj.hasOwnProperty(key) && ModelV5_1.myInternalProperties.indexOf(key) === -1) {\n        this[key] = obj[key];\n      }\n    }\n  };\n\n  var ModelV5_1;\n  ModelV5.myInternalProperties = ['Id', 'MapperId', 'References', 'EventChanges', '_internalProperties', 'childrenToNotify', 'onModelChange', '_isTempModel', '_pointers', 'Style'];\n  ModelV5 = ModelV5_1 = __decorate([ExceptionHandlerClass(ErrorCodes.ClientCore), __metadata(\"design:paramtypes\", [String, Object])], ModelV5);\n  return ModelV5;\n}(Model);\n\nexport { ModelV5 }; //# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiTW9kZWwuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi9zcmMvdjUvQ29yZS9Nb2RlbC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFtQkEsT0FBTyxFQUFFLEtBQUssRUFBRSxNQUFNLFlBQVksQ0FBQztBQUNuQyxPQUFPLEVBQUUsVUFBVSxFQUFFLHFCQUFxQixFQUFFLE1BQU0sa0JBQWtCLENBQUM7QUFHckU7SUFBNkIsMkJBQUs7SUFhOUIsaUJBQVksRUFBVSxFQUFFLFVBQTRCO1FBQXBELFlBQ0ksa0JBQU0sRUFBRSxDQUFDLFNBRVo7UUFERyxLQUFJLENBQUMsT0FBTyxDQUFDLEVBQUUsRUFBRSxVQUFVLENBQUMsQ0FBQzs7SUFDakMsQ0FBQztnQkFoQlEsT0FBTztJQUtoQixzQkFBSSw2QkFBUTthQUFaO1lBQ0ksT0FBTyxJQUFJLENBQUMsRUFBRSxDQUFDO1FBQ25CLENBQUM7YUFFRCxVQUFhLEtBQWE7WUFDdEIsSUFBSSxDQUFDLEVBQUUsR0FBRyxLQUFLLENBQUM7UUFDcEIsQ0FBQzs7O09BSkE7SUFXRCx5QkFBTyxHQUFQLFVBQVEsRUFBVSxFQUFFLFVBQTRCO1FBRTVDLElBQUksQ0FBQyxFQUFFLEdBQUcsRUFBRSxDQUFDO1FBQ2IsSUFBSSxDQUFDLFVBQVUsR0FBRyxFQUFFLENBQUM7UUFDckIsSUFBSSxDQUFDLFlBQVksR0FBRyxFQUFFLENBQUM7UUFHdkIsSUFBSSxVQUFVLEVBQUU7WUFDWixJQUFJLENBQUMsVUFBVSxHQUFHLFVBQVUsQ0FBQyxVQUFVLENBQUMsQ0FBQyxDQUFDLFVBQVUsQ0FBQyxVQUFVLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQztZQUNyRSxJQUFJLENBQUMsUUFBUSxHQUFHLFVBQVUsQ0FBQyxRQUFRLENBQUM7WUFDcEMsSUFBSSxDQUFDLFlBQVksR0FBRyxVQUFVLENBQUMsWUFBWSxDQUFDLENBQUMsQ0FBQyxVQUFVLENBQUMsWUFBWSxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUM7WUFDM0UsSUFBSSxDQUFDLFVBQVUsR0FBRyxVQUFVLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxVQUFVLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUM7U0FDOUQ7UUFHRCxJQUFJLENBQUMsYUFBYSxDQUFDLFVBQVUsQ0FBQyxDQUFDO0lBRW5DLENBQUM7SUFFRCxpQ0FBZSxHQUFmLFVBQWdCLE9BQWUsRUFBRSxJQUFZO1FBQ3pDLElBQUksQ0FBQyxZQUFZLENBQUMsT0FBTyxDQUFDLEdBQUcsSUFBSSxDQUFDO0lBQ3RDLENBQUM7SUFFRCxpQ0FBZSxHQUFmLFVBQWdCLElBQVk7UUFDeEIsT0FBTyxJQUFJLENBQUMsVUFBVSxDQUFDLElBQUksQ0FBQyxDQUFDO1FBQzdCLE9BQU8sSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO0lBQ3RCLENBQUM7SUFFRCxtQ0FBaUIsR0FBakIsVUFBa0IsSUFBWSxFQUFFLEVBQTJCO1FBQ3ZELEtBQUssSUFBTSxJQUFJLElBQUksSUFBSSxFQUFFO1lBRXJCLElBQUksSUFBSSxDQUFDLGNBQWMsQ0FBQyxJQUFJLENBQUMsSUFBSSxTQUFPLENBQUMsb0JBQW9CLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQyxFQUFFO2dCQUNoRixFQUFFLENBQUMsSUFBSSxDQUFDLElBQUksRUFBRSxJQUFJLENBQUMsQ0FBQzthQUN2QjtpQkFBTSxJQUFJLElBQUksS0FBSyxTQUFPLENBQUMsb0JBQW9CLENBQUMsQ0FBQyxDQUFDLEVBQUU7Z0JBQ2pELElBQUksQ0FBQyxxQkFBcUIsQ0FBQyxJQUFJLENBQUMsQ0FBQzthQUNwQztTQUNKO0lBQ0wsQ0FBQztJQU9TLHVDQUFxQixHQUEvQixVQUFnQyxVQUFlO1FBQzNDLEtBQUssSUFBTSxHQUFHLElBQUksVUFBVSxDQUFDLFVBQVUsRUFBRTtZQUNyQyxJQUFJLFVBQVUsQ0FBQyxVQUFVLENBQUMsY0FBYyxDQUFDLEdBQUcsQ0FBQyxFQUFFO2dCQUMzQyxJQUFJLENBQUMsVUFBVSxDQUFDLEdBQUcsQ0FBQyxHQUFHLFVBQVUsQ0FBQyxVQUFVLENBQUMsR0FBRyxDQUFDLENBQUM7YUFDckQ7U0FDSjtJQUNMLENBQUM7SUFFUywrQkFBYSxHQUF2QixVQUF3QixHQUFRO1FBQzVCLEtBQUssSUFBTSxHQUFHLElBQUksR0FBRyxFQUFFO1lBQ25CLElBQUksR0FBRyxDQUFDLGNBQWMsQ0FBQyxHQUFHLENBQUMsSUFBSSxTQUFPLENBQUMsb0JBQW9CLENBQUMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxLQUFLLENBQUMsQ0FBQyxFQUFFO2dCQUM3RSxJQUFJLENBQUMsR0FBRyxDQUFDLEdBQUcsR0FBRyxDQUFDLEdBQUcsQ0FBQyxDQUFDO2FBQ3hCO1NBQ0o7SUFDTCxDQUFDOztJQTFFZ0IsNEJBQW9CLEdBQUcsQ0FBQyxJQUFJLEVBQUUsVUFBVSxFQUFFLFlBQVksRUFBRSxjQUFjLEVBQUUscUJBQXFCO1FBQzFHLGtCQUFrQixFQUFFLGVBQWUsRUFBRSxjQUFjLEVBQUUsV0FBVyxFQUFFLE9BQU8sQ0FBRSxDQUFBO0lBSHRFLE9BQU87UUFEbkIscUJBQXFCLENBQUMsVUFBVSxDQUFDLFVBQVUsQ0FBQzs7T0FDaEMsT0FBTyxDQTZFbkI7SUFBRCxjQUFDO0NBQUEsQUE3RUQsQ0FBNkIsS0FBSyxHQTZFakM7U0E3RVksT0FBTyIsInNvdXJjZXNDb250ZW50IjpbIi8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxyXG4qIENvcHlyaWdodCAoQykgTW9iaWxpemUuTmV0IDxpbmZvQG1vYmlsaXplLm5ldD4gLSBBbGwgUmlnaHRzIFJlc2VydmVkXHJcbipcclxuKiBUaGlzIGZpbGUgaXMgcGFydCBvZiB0aGUgTW9iaWxpemUgRnJhbWV3b3Jrcywgd2hpY2ggaXNcclxuKiBwcm9wcmlldGFyeSBhbmQgY29uZmlkZW50aWFsLlxyXG4qXHJcbiogTk9USUNFOiAgQWxsIGluZm9ybWF0aW9uIGNvbnRhaW5lZCBoZXJlaW4gaXMsIGFuZCByZW1haW5zXHJcbiogdGhlIHByb3BlcnR5IG9mIE1vYmlsaXplLk5ldCBDb3Jwb3JhdGlvbi5cclxuKiBUaGUgaW50ZWxsZWN0dWFsIGFuZCB0ZWNobmljYWwgY29uY2VwdHMgY29udGFpbmVkIGhlcmVpbiBhcmVcclxuKiBwcm9wcmlldGFyeSB0byBNb2JpbGl6ZS5OZXQgQ29ycG9yYXRpb24gYW5kIG1heSBiZSBjb3ZlcmVkXHJcbiogYnkgVS5TLiBQYXRlbnRzLCBhbmQgYXJlIHByb3RlY3RlZCBieSB0cmFkZSBzZWNyZXQgb3IgY29weXJpZ2h0IGxhdy5cclxuKiBEaXNzZW1pbmF0aW9uIG9mIHRoaXMgaW5mb3JtYXRpb24gb3IgcmVwcm9kdWN0aW9uIG9mIHRoaXMgbWF0ZXJpYWxcclxuKiBpcyBzdHJpY3RseSBmb3JiaWRkZW4gdW5sZXNzIHByaW9yIHdyaXR0ZW4gcGVybWlzc2lvbiBpcyBvYnRhaW5lZFxyXG4qIGZyb20gTW9iaWxpemUuTmV0IENvcnBvcmF0aW9uLlxyXG4qXHJcbiogVGhpcyBmaWxlIGlzIHN1YmplY3QgdG8gdGhlIHRlcm1zIGFuZCBjb25kaXRpb25zIGRlZmluZWQgaW5cclxuKiBmaWxlICdMSUNFTlNFLnR4dCcsIHdoaWNoIGlzIHBhcnQgb2YgdGhpcyBzb3VyY2UgY29kZSBwYWNrYWdlLlxyXG4qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cclxuaW1wb3J0IHsgSU1vZGVsLCBJTW9kZWxQcm9qZWN0aW9uIH0gZnJvbSAnLi4vLi4vQ29udHJhY3QnO1xyXG5pbXBvcnQgeyBNb2RlbCB9IGZyb20gJy4uLy4uL0NvcmUnO1xyXG5pbXBvcnQgeyBFcnJvckNvZGVzLCBFeGNlcHRpb25IYW5kbGVyQ2xhc3MgfSBmcm9tICcuLi8uLi9TeXN0ZW0vQW9wJztcclxuXHJcbkBFeGNlcHRpb25IYW5kbGVyQ2xhc3MoRXJyb3JDb2Rlcy5DbGllbnRDb3JlKVxyXG5leHBvcnQgY2xhc3MgTW9kZWxWNSBleHRlbmRzIE1vZGVsIGltcGxlbWVudHMgSU1vZGVsIHtcclxuXHJcbiAgICBwcm90ZWN0ZWQgc3RhdGljIG15SW50ZXJuYWxQcm9wZXJ0aWVzID0gWydJZCcsICdNYXBwZXJJZCcsICdSZWZlcmVuY2VzJywgJ0V2ZW50Q2hhbmdlcycsICdfaW50ZXJuYWxQcm9wZXJ0aWVzJyxcclxuICAgICAgICAnY2hpbGRyZW5Ub05vdGlmeScsICdvbk1vZGVsQ2hhbmdlJywgJ19pc1RlbXBNb2RlbCcsICdfcG9pbnRlcnMnLCAnU3R5bGUnXTtcclxuXHJcbiAgICBnZXQgVW5pcXVlSUQoKTogc3RyaW5nIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5pZDtcclxuICAgIH1cclxuXHJcbiAgICBzZXQgVW5pcXVlSUQodmFsdWU6IHN0cmluZykge1xyXG4gICAgICAgIHRoaXMuaWQgPSB2YWx1ZTtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdHJ1Y3RvcihpZDogc3RyaW5nLCBwcm9qZWN0aW9uOiBJTW9kZWxQcm9qZWN0aW9uKSB7XHJcbiAgICAgICAgc3VwZXIoaWQpO1xyXG4gICAgICAgIHRoaXMuX19faW5pdChpZCwgcHJvamVjdGlvbik7XHJcbiAgICB9XHJcblxyXG4gICAgX19faW5pdChpZDogc3RyaW5nLCBwcm9qZWN0aW9uOiBJTW9kZWxQcm9qZWN0aW9uKTogdm9pZCB7XHJcbiAgICAgICAgLy8gaW5pdGlhbCB2YWx1ZXNcclxuICAgICAgICB0aGlzLmlkID0gaWQ7XHJcbiAgICAgICAgdGhpcy5yZWZlcmVuY2VzID0ge307XHJcbiAgICAgICAgdGhpcy5yZWZlcmVuY2VkQnkgPSB7fTtcclxuXHJcbiAgICAgICAgLy8gZ2V0IHNwZWNpZmljIHByb3BlcnRpZXMgZnJvbSB0aGUgTW9kZWwgUHJvamVjdGlvblxyXG4gICAgICAgIGlmIChwcm9qZWN0aW9uKSB7XHJcbiAgICAgICAgICAgIHRoaXMucmVmZXJlbmNlcyA9IHByb2plY3Rpb24uUmVmZXJlbmNlcyA/IHByb2plY3Rpb24uUmVmZXJlbmNlcyA6IHt9O1xyXG4gICAgICAgICAgICB0aGlzLm1hcHBlcklkID0gcHJvamVjdGlvbi5NYXBwZXJJZDtcclxuICAgICAgICAgICAgdGhpcy5ldmVudENoYW5nZXMgPSBwcm9qZWN0aW9uLkV2ZW50Q2hhbmdlcyA/IHByb2plY3Rpb24uRXZlbnRDaGFuZ2VzIDoge307XHJcbiAgICAgICAgICAgIHRoaXMuc3R5bGVQaXZvdCA9IHByb2plY3Rpb24uU3R5bGUgPyBwcm9qZWN0aW9uLlN0eWxlIDoge307XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBhZGQgdGhlIHJlc3Qgb2YgdGhlIHByb3BlcnRpZXNcclxuICAgICAgICB0aGlzLmFkZFByb3BlcnRpZXMocHJvamVjdGlvbik7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIGFkZFJlZmVyZW5jZWRCeShtb2RlbElkOiBzdHJpbmcsIG5hbWU6IHN0cmluZyk6IHZvaWQge1xyXG4gICAgICAgIHRoaXMucmVmZXJlbmNlZEJ5W21vZGVsSWRdID0gbmFtZTtcclxuICAgIH1cclxuXHJcbiAgICByZW1vdmVSZWZlcmVuY2UobmFtZTogc3RyaW5nKTogdm9pZCB7XHJcbiAgICAgICAgZGVsZXRlIHRoaXMucmVmZXJlbmNlc1tuYW1lXTtcclxuICAgICAgICBkZWxldGUgdGhpc1tuYW1lXTtcclxuICAgIH1cclxuXHJcbiAgICBhcHBseU9uUHJvcGVydGllcyhpdGVtOiBJTW9kZWwsIGZuOiAocHJvcGVydHk6IGFueSkgPT4gdm9pZCk6IHZvaWQge1xyXG4gICAgICAgIGZvciAoY29uc3QgcHJvcCBpbiBpdGVtKSB7XHJcbiAgICAgICAgICAgIC8vIHNraXAgdGhlIGludGVybmFsIHByb3BlcnRpZXMgdGhhdCBzaG91bGRuJ3QgYmUgdXBkYXRlZCB3aGVuIGFwcGx5aW5nIHRoZSBkZWx0YXNcclxuICAgICAgICAgICAgaWYgKGl0ZW0uaGFzT3duUHJvcGVydHkocHJvcCkgJiYgTW9kZWxWNS5teUludGVybmFsUHJvcGVydGllcy5pbmRleE9mKHByb3ApID09PSAtMSkge1xyXG4gICAgICAgICAgICAgICAgZm4uY2FsbCh0aGlzLCBwcm9wKTtcclxuICAgICAgICAgICAgfSBlbHNlIGlmIChwcm9wID09PSBNb2RlbFY1Lm15SW50ZXJuYWxQcm9wZXJ0aWVzWzJdKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmFwcGx5UmVmZXJlbmNlc0RlbHRhcyhpdGVtKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIEFwcGxpZXMgZGVsdGFzIHRvIHY1IG1vZGVsIHJlZmVyZW5jZXMsIHRoaXMgZnVuY3Rpb24gb3ZlcnJpZGVzIHByZXZpb3VzIHJlZmVyZW5jZXMgd2l0aFxyXG4gICAgICogbmV3IHZhbHVlcyByZWNlaXZlZCBmcm9tIGNoYW5nZXMgc2VjdGlvbiBvZiByZXNwb25zZS5cclxuICAgICAqIEBwYXJhbSBwcm9qZWN0aW9uIE1vZGVsIHByb2plY3Rpb24gd2l0aCBuZXcgUmVmZXJlbmNlcyB2YWx1ZXNcclxuICAgICAqL1xyXG4gICAgcHJvdGVjdGVkIGFwcGx5UmVmZXJlbmNlc0RlbHRhcyhwcm9qZWN0aW9uOiBhbnkpOiB2b2lkIHtcclxuICAgICAgICBmb3IgKGNvbnN0IHJlZiBpbiBwcm9qZWN0aW9uLlJlZmVyZW5jZXMpIHtcclxuICAgICAgICAgICAgaWYgKHByb2plY3Rpb24uUmVmZXJlbmNlcy5oYXNPd25Qcm9wZXJ0eShyZWYpKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnJlZmVyZW5jZXNbcmVmXSA9IHByb2plY3Rpb24uUmVmZXJlbmNlc1tyZWZdO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHByb3RlY3RlZCBhZGRQcm9wZXJ0aWVzKG9iajogYW55KTogdm9pZCB7XHJcbiAgICAgICAgZm9yIChjb25zdCBrZXkgaW4gb2JqKSB7XHJcbiAgICAgICAgICAgIGlmIChvYmouaGFzT3duUHJvcGVydHkoa2V5KSAmJiBNb2RlbFY1Lm15SW50ZXJuYWxQcm9wZXJ0aWVzLmluZGV4T2Yoa2V5KSA9PT0gLTEpIHtcclxuICAgICAgICAgICAgICAgIHRoaXNba2V5XSA9IG9ialtrZXldO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcbiJdfQ==","map":null,"metadata":{},"sourceType":"module"}